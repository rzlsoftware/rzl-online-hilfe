# KB0026 - RZL Datenbank Setup Fehlercodes

## Fehlercode 18

**Beschreibung:**  
Der aktuelle Windows-Benutzer hat nicht die nötigen Berechtigungen auf der Datenbank, um diese zu aktualisieren. Der Benutzer muss der Datenbankrolle *rzl_admin* und der Serverrolle *rzl_server_admin* zugewiesen sein.

### Ursache

Dieses Problem tritt auf, wenn dem Windows-Benutzer nicht die folgenden Rollen auf der Datenbank oder dem SQL Server zugewiesen sind:

- **Datenbank:** *rzl_admin*
- **SQL Server:** *rzl_server_admin*

### Lösung

Die folgende Anleitung richtet sich an EDV-Betreuer/Systemadministratoren.

#### Rechte auf der Datenbank vergeben

1. Starten Sie das **SQL Server Management Studio** auf dem Datenbankserver und verbinden Sie sich mit der Instanz *SQLEXPRESS_RZL*.
2. Navigieren Sie zum Ordner **Sicherheit → Anmeldungen** und legen Sie eine neue Anmeldung für den betroffenen Windows-Benutzer bzw. die betroffene Benutzergruppe an.
3. Wechseln Sie zur Seite **Serverrollen** und aktivieren Sie das Kästchen bei der Serverrolle *rzl_server_admin*.
4. Schließen Sie den Dialog mit der **OK-Schaltfläche**.

#### Zuweisung der Benutzerrolle in der Datenbank

1. Wählen Sie unter **Datenbanken** die Datenbank *RZLZMV_[Anwendernummer]* aus und navigieren Sie zum Ordner **Sicherheit → Benutzer**.
2. Wählen Sie aus dem Kontextmenü die Option **Neuer Benutzer...**.
3. Wählen Sie unter **Benutzertyp** „Windows-Benutzer“, vergeben Sie einen Benutzernamen und tragen Sie den zuvor angelegten Anmeldenamen ein.
4. Unter dem Punkt **Mitgliedschaft in Datenbankrollen** wählen Sie *rzl_admin* aus.

## Fehlercode 19

**Beschreibung:**  
Die Datenbank konnte nicht gesichert werden.

### Ursache

Dieses Problem kann mehrere Ursachen haben:

- Dem Windows-Benutzer sind nicht die folgenden Rollen auf der Datenbank oder dem SQL Server zugewiesen:
    - **Datenbank:** *rzl_admin*
    - **SQL Server:** *rzl_server_admin*
- Der Dienstbenutzer des SQL Servers hat keine Schreibrechte auf den Sicherungspfad. Standardmäßig befindet sich dieser im Datenrepository unter *SQL_Backup* oder es wird der konfigurierte Wert für *BackupPfad* in der *RZLDb.ini* verwendet.

### Lösung

Die folgende Anleitung richtet sich an EDV-Betreuer/Systemadministratoren.

#### Rechte auf der Datenbank vergeben

1. Starten Sie das **SQL Server Management Studio** auf dem Datenbankserver und verbinden Sie sich mit der Instanz *SQLEXPRESS_RZL*.
2. Navigieren Sie zum Ordner **Sicherheit → Anmeldungen** und legen Sie eine neue Anmeldung für den betroffenen Windows-Benutzer bzw. die betroffene Benutzergruppe an.
3. Wechseln Sie zur Seite **Serverrollen** und aktivieren Sie das Kästchen bei der Serverrolle *rzl_server_admin*.
4. Schließen Sie den Dialog mit der **OK-Schaltfläche**.

#### Zuweisung der Benutzerrolle in der Datenbank

1. Wählen Sie unter **Datenbanken** die Datenbank *RZLZMV_[Anwendernummer]* und navigieren Sie zum Ordner **Sicherheit → Benutzer**.
2. Wählen Sie aus dem Kontextmenü die Option **Neuer Benutzer...**.
3. Wählen Sie unter **Benutzertyp** „Windows-Benutzer“, vergeben Sie einen Benutzernamen und tragen Sie den zuvor angelegten Anmeldenamen ein.
4. Unter dem Punkt **Mitgliedschaft in Datenbankrollen** wählen Sie *rzl_admin* aus.

#### Dienstbenutzer Vollzugriff auf den Sicherungspfad geben

1. Rufen Sie die **Windows-Dienste** auf und suchen Sie den SQL Server-Dienst, z.B. *SQL Server (SQLEXPRESS_RZL)*.
2. Unter **Eigenschaften → Anmelden** kopieren Sie den vollständigen Anmeldenamen des Dienstes, z.B. *NT Service\MSSQL$SQLEXPRESS_RZL*.
3. Navigieren Sie im **Windows Explorer** zum Sicherungspfad und rufen Sie die **Eigenschaften** auf.
4. Unter **Sicherheit** wählen Sie **Bearbeiten...** und **Hinzufügen...**.
     1. Berechtigen Sie den zuvor kopierten Anmeldenamen mit **Vollzugriff** auf den Ordner. Stellen Sie sicher, dass Sie bei Suchpfad den lokalen Computer und nicht die Domäne gewählt haben.
     2. Sollte es sich beim Sicherungspfad um einen Netzwerkpfad auf einem anderen Computer handeln, müssen Sie statt dem Dienstbenutzer den Computer, auf dem der SQL Server installiert ist, mit **Vollzugriff** berechtigen.